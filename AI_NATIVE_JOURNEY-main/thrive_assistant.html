<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thrive Assistant</title>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            height: 100vh;
            min-height: 100vh;
            overflow: hidden;
            transition: all 0.8s ease;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.2) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* Portal Backgrounds */
        body.portal-daycare {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            animation: daycarePortal 20s ease infinite;
        }

        body.portal-evening {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #2c3e50 100%);
            animation: eveningPortal 25s ease infinite;
        }

        body.portal-class {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 50%, #43e97b 100%);
            animation: classPortal 18s ease infinite;
        }

        @keyframes daycarePortal {
            0% { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%); }
            25% { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 50%, #ff9a9e 100%); }
            50% { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 50%, #ff9a9e 100%); }
            75% { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 50%, #ff9a9e 100%); }
            100% { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%); }
        }

        @keyframes eveningPortal {
            0% { background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #2c3e50 100%); }
            25% { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 50%, #667eea 100%); }
            50% { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 50%, #764ba2 100%); }
            75% { background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #2c3e50 100%); }
            100% { background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #2c3e50 100%); }
        }

        @keyframes classPortal {
            0% { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 50%, #43e97b 100%); }
            25% { background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #4facfe 100%); }
            50% { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 50%, #00f2fe 100%); }
            75% { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 50%, #43e97b 100%); }
            100% { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 50%, #43e97b 100%); }
        }

        .split-container {
            display: flex;
            height: 100vh;
            min-height: 100vh;
            animation: slideIn 1s ease-out;
            position: relative;
            z-index: 1;
        }

        .left-half {
            width: 50vw;
            height: 100vh;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: stretch;
            justify-content: stretch;
            overflow: hidden;
            padding: 0;
            margin: 0;
            position: relative;
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600"><defs><linearGradient id="bg" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:%23667eea;stop-opacity:0.8"/><stop offset="100%" style="stop-color:%23764ba2;stop-opacity:0.8"/></linearGradient><radialGradient id="glow" cx="50%" cy="50%" r="50%"><stop offset="0%" style="stop-color:%23FFFFFF;stop-opacity:0.3"/><stop offset="100%" style="stop-color:%23FFFFFF;stop-opacity:0"/></radialGradient></defs><rect width="800" height="600" fill="url(%23bg)"/><circle cx="400" cy="300" r="200" fill="url(%23glow)"/><g transform="translate(400,300)"><!-- Father figure --><circle cx="-80" cy="-60" r="40" fill="%23D4A574" stroke="%23B8860B" stroke-width="3"/><rect x="-100" y="-20" width="60" height="80" fill="%234A90E2" rx="5"/><rect x="-95" y="-15" width="50" height="60" fill="%23366AB7" rx="3"/><rect x="-85" y="60" width="20" height="40" fill="%232C3E50" rx="3"/><rect x="-65" y="60" width="20" height="40" fill="%232C3E50" rx="3"/><!-- Son figure --><circle cx="40" cy="-40" r="25" fill="%23D4A574" stroke="%23B8860B" stroke-width="2"/><rect x="25" y="-15" width="30" height="50" fill="%23E74C3C" rx="4"/><rect x="30" y="-10" width="20" height="35" fill="%23C0392B" rx="2"/><rect x="30" y="35" width="8" height="25" fill="%232C3E50" rx="2"/><rect x="42" y="35" width="8" height="25" fill="%232C3E50" rx="2"/><!-- Holding hands --><path d="M -40 -20 Q -20 -30 0 -25" stroke="%23D4A574" stroke-width="4" fill="none" stroke-linecap="round"/><!-- Heart symbol --><g transform="translate(0,-80)"><path d="M -15 0 C -15 -10 -5 -15 0 -10 C 5 -15 15 -10 15 0 C 15 10 0 20 0 20 C 0 20 -15 10 -15 0 Z" fill="%23FF6B6B" opacity="0.8"/></g><!-- Floating elements --><text x="-120" y="-120" fill="%23FFFFFF" font-size="24" opacity="0.6">üåü</text><text x="120" y="-100" fill="%23FFFFFF" font-size="20" opacity="0.6">üíô</text><text x="-140" y="80" fill="%23FFFFFF" font-size="18" opacity="0.6">üë®‚Äçüë¶</text><text x="140" y="100" fill="%23FFFFFF" font-size="22" opacity="0.6">‚ù§Ô∏è</text></g></svg>');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .right-half {
            width: 50vw;
            height: 100vh;
            overflow-y: auto;
            padding: 40px 5vw 40px 5vw;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(30px);
            border-radius: 20px 0 0 20px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            animation: fadeInRight 1.2s ease-out 0.3s both;
            position: relative;
            z-index: 1;
        }

        @media (max-width: 900px) {
            .split-container {
                flex-direction: column;
            }
            .left-half, .right-half {
                width: 100vw;
                height: 40vh;
            }
            .right-half {
                height: auto;
                padding: 24px 4vw;
            }
        }
        .welcome-section {
            background: #e0f0ff;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            padding: 0;
            margin: 0 0 40px 0;
            position: relative;
            border-radius: 20px;
            min-height: 200px;
        }
        .welcome-content {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.85) 0%, rgba(118, 75, 162, 0.85) 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            padding: 40px;
            border-radius: 0 20px 20px 0;
            box-shadow: 
                0 0 24px rgba(0,0,0,0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            animation: welcomePulse 3s ease-in-out infinite;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px);
            z-index: 2;
        }
        
        .welcome-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 70%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 70% 30%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        
        @keyframes welcomePulse {
            0%, 100% { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
            25% { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
            50% { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
            75% { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        }
        
        .welcome-content:hover {
            transform: scale(1.02);
        }
        .welcome-content h2 {
            font-size: 3.5em;
            margin: 0 0 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            background: none;
            border-left: none;
            padding: 0;
            animation: titleGlow 2s ease-in-out infinite alternate;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            z-index: 2;
            font-weight: 700;
            letter-spacing: 2px;
        }
        
        .welcome-content h2:hover {
            transform: scale(1.1) rotate(2deg);
            text-shadow: 0 0 30px rgba(255,255,255,0.8);
        }
        
        @keyframes titleGlow {
            from { text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
            to { text-shadow: 0 0 20px rgba(255,255,255,0.6); }
        }
        
        .welcome-content p {
            font-size: 1.4em;
            margin: 0 0 30px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            position: relative;
            z-index: 2;
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .welcome-description {
            background: rgba(255,255,255,0.15);
            padding: 20px 30px;
            border-radius: 30px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.3);
            transition: all 0.3s ease;
            cursor: pointer;
            animation: descriptionFloat 3s ease-in-out infinite;
            position: relative;
            z-index: 2;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .welcome-description:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 15px 35px rgba(255,255,255,0.2);
        }
        
        .welcome-description span {
            font-size: 1.3em;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            animation: textShimmer 2s ease-in-out infinite;
            letter-spacing: 1px;
        }
        
        @keyframes descriptionFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes textShimmer {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .content-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            animation: fadeInRight 1.2s ease-out 0.3s both;
            padding: 40px;
        }
        
        @keyframes fadeInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Main Emoji Screen */
        .main-emoji-screen {
            display: none;
            text-align: center;
            padding: 40px 20px;
            animation: fadeIn 0.8s ease-out;
            position: relative;
        }

        .main-emoji-screen.active {
            display: block;
        }

        .main-emoji-screen h2 {
            font-size: 2.8em;
            margin-bottom: 50px;
            color: #2c3e50;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            animation: titleGlow 2s ease-in-out infinite alternate;
            font-weight: 700;
            letter-spacing: 3px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .main-emoji-container {
            display: flex;
            justify-content: center;
            gap: 50px;
            flex-wrap: wrap;
            max-width: 900px;
            margin: 0 auto;
        }

        .main-emoji-btn {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 249, 255, 0.9) 100%);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 30px;
            padding: 40px 30px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(20px);
            min-width: 220px;
            animation: emojiFloat 4s ease-in-out infinite;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
            position: relative;
            overflow: hidden;
        }

        .main-emoji-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.6s;
        }

        .main-emoji-btn:hover::before {
            left: 100%;
        }

        .main-emoji-btn:nth-child(1) { animation-delay: 0s; }
        .main-emoji-btn:nth-child(2) { animation-delay: 1.5s; }
        .main-emoji-btn:nth-child(3) { animation-delay: 3s; }

        .main-emoji-btn:hover {
            transform: scale(1.08) translateY(-20px);
            background: linear-gradient(135deg, rgba(255, 255, 255, 1) 0%, rgba(248, 249, 255, 1) 100%);
            border-color: rgba(102, 126, 234, 0.5);
            box-shadow: 
                0 20px 50px rgba(102, 126, 234, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }

        .emoji-display {
            font-size: 5.5em;
            margin-bottom: 20px;
            display: block;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
        }

        .main-emoji-btn:hover .emoji-display {
            transform: scale(1.3) rotate(8deg);
            filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.2));
        }

        .emoji-label {
            font-size: 1.4em;
            font-weight: 600;
            color: #2c3e50;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            letter-spacing: 1px;
            transition: all 0.3s ease;
        }

        .main-emoji-btn:hover .emoji-label {
            color: #667eea;
            transform: scale(1.05);
        }

        @keyframes emojiFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        /* Task List */
        .task-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 30px;
        }

        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 249, 255, 0.95) 100%);
            border: 2px solid transparent;
            border-radius: 20px;
            padding: 25px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .task-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.6s;
        }

        .task-item:hover::before {
            left: 100%;
        }

        .task-item:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: #667eea;
            box-shadow: 
                0 15px 40px rgba(102, 126, 234, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            background: linear-gradient(135deg, rgba(255, 255, 255, 1) 0%, rgba(232, 242, 255, 1) 100%);
        }

        .task-item .task-time {
            font-weight: 600;
            color: #667eea;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 10px;
            transition: all 0.3s ease;
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid transparent;
        }

        .task-item .task-time:hover {
            background: rgba(102, 126, 234, 0.2);
            border-color: #667eea;
            transform: scale(1.05);
        }

        .speak-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.3);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        .speak-btn:hover {
            transform: translateY(-3px) scale(1.1);
            box-shadow: 0 10px 30px rgba(40, 167, 69, 0.4);
            background: linear-gradient(135deg, #20c997 0%, #28a745 100%);
        }

        .speak-btn:active {
            transform: translateY(-1px) scale(1.05);
        }

        /* Section Content */
        .section-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .section-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-header {
            margin-bottom: 20px;
        }

        .section-header .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .section-header .header-top h2 {
            margin: 0;
            flex: 1;
            text-align: center;
        }

        .section-header .back-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .section-header .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        /* Sub-task Folders */
        .sub-task-folders {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }

        .sub-task-folder {
            display: flex;
            align-items: center;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 249, 255, 0.9) 100%);
            border: 2px solid transparent;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .sub-task-folder::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.5s;
        }

        .sub-task-folder:hover::before {
            left: 100%;
        }

        .sub-task-folder:hover {
            transform: translateY(-5px) scale(1.02);
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            background: linear-gradient(135deg, rgba(255, 255, 255, 1) 0%, rgba(232, 242, 255, 1) 100%);
        }

        .folder-icon {
            font-size: 2.5em;
            margin-right: 20px;
            transition: all 0.3s ease;
        }

        .sub-task-folder:hover .folder-icon {
            transform: scale(1.2) rotate(5deg);
        }

        .folder-info {
            flex: 1;
        }

        .folder-info h3 {
            margin: 0 0 5px 0;
            color: #333;
            font-size: 1.2em;
            font-weight: 600;
        }

        .folder-info .task-time {
            margin: 0;
            color: #667eea;
            font-weight: 500;
            font-size: 0.9em;
        }

        .folder-arrow {
            font-size: 1.5em;
            opacity: 0.6;
            transition: all 0.3s ease;
        }

        .sub-task-folder:hover .folder-arrow {
            opacity: 1;
            transform: translateX(5px);
        }

        /* Sub-task Detail View */
        .sub-task-detail {
            display: none;
            animation: slideInDetail 0.5s ease-out;
        }

        .sub-task-detail.active {
            display: block;
        }

        @keyframes slideInDetail {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .task-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .action-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        /* Portal Elements */
        .portal-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0;
            transition: opacity 1.5s ease;
        }

        .portal-elements.active {
            opacity: 1;
        }

        .daycare-elements {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .evening-elements {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .class-elements {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .floating-element {
            position: absolute;
            font-size: 2.5em;
            animation: floatAround 20s linear infinite;
            opacity: 0.4;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
        }

        .daycare-elements .floating-element:nth-child(1) { top: 10%; left: 10%; animation-delay: 0s; }
        .daycare-elements .floating-element:nth-child(2) { top: 20%; right: 15%; animation-delay: 5s; }
        .daycare-elements .floating-element:nth-child(3) { bottom: 30%; left: 20%; animation-delay: 10s; }
        .daycare-elements .floating-element:nth-child(4) { bottom: 20%; right: 10%; animation-delay: 15s; }

        .evening-elements .floating-element:nth-child(1) { top: 15%; left: 15%; animation-delay: 0s; }
        .evening-elements .floating-element:nth-child(2) { top: 25%; right: 20%; animation-delay: 6s; }
        .evening-elements .floating-element:nth-child(3) { bottom: 25%; left: 25%; animation-delay: 12s; }
        .evening-elements .floating-element:nth-child(4) { bottom: 15%; right: 15%; animation-delay: 18s; }

        .class-elements .floating-element:nth-child(1) { top: 12%; left: 12%; animation-delay: 0s; }
        .class-elements .floating-element:nth-child(2) { top: 22%; right: 18%; animation-delay: 7s; }
        .class-elements .floating-element:nth-child(3) { bottom: 28%; left: 22%; animation-delay: 14s; }
        .class-elements .floating-element:nth-child(4) { bottom: 18%; right: 12%; animation-delay: 21s; }

        @keyframes floatAround {
            0% { transform: translate(0, 0) rotate(0deg) scale(1); }
            25% { transform: translate(100px, -50px) rotate(90deg) scale(1.1); }
            50% { transform: translate(50px, -100px) rotate(180deg) scale(0.9); }
            75% { transform: translate(-50px, -50px) rotate(270deg) scale(1.1); }
            100% { transform: translate(0, 0) rotate(360deg) scale(1); }
        }
        .header {
            text-align: left;
            margin-bottom: 30px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 249, 255, 0.95) 100%);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }



        h1 {
            margin-top: 0;
            color: #2c3e50;
            font-size: 2.8em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            animation: pulse 2s ease-in-out infinite;
            font-weight: 700;
            letter-spacing: 2px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            margin: 8px 0;
            font-size: 1.1em;
            color: #555;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .header strong {
            color: #667eea;
            font-weight: 600;
        }

        /* Date and Time Dropdown Styles */
        .date-time-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .date-dropdown, .time-dropdown {
            position: relative;
            display: inline-block;
        }

        .date-dropdown p, .time-dropdown p {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0;
            font-size: 1.1em;
            color: #555;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .dropdown-arrow {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
            margin-left: 10px;
        }

        .dropdown-arrow:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 249, 255, 0.95) 100%);
            min-width: 250px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-radius: 15px;
            padding: 20px;
            z-index: 1000;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: dropdownSlide 0.3s ease-out;
        }

        .dropdown-content.show {
            display: block;
        }

        @keyframes dropdownSlide {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dropdown-content input[type="date"], .dropdown-content input[type="time"] {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 10px;
            font-size: 1em;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .dropdown-content input[type="date"]:focus, .dropdown-content input[type="time"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .dropdown-content button {
            width: 100%;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .dropdown-content button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        .section-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 249, 255, 0.95) 100%);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 
                0 15px 40px rgba(0, 0, 0, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .section-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-header {
            margin-bottom: 30px;
        }

        .section-header .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-header .header-top h2 {
            margin: 0;
            flex: 1;
            text-align: center;
            font-size: 2.2em;
            font-weight: 700;
            letter-spacing: 1px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
        }

        .section-header .back-btn {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.9) 0%, rgba(118, 75, 162, 0.9) 100%);
            border: none;
            color: white;
            padding: 12px 18px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(10px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
            letter-spacing: 0.5px;
        }

        .section-header .back-btn:hover {
            background: linear-gradient(135deg, rgba(118, 75, 162, 0.9) 0%, rgba(102, 126, 234, 0.9) 100%);
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .time-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            padding: 15px 20px;
            border-radius: 15px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .time-header p {
            margin: 0;
            font-size: 1.1em;
            font-weight: 600;
            color: #2c3e50;
        }

        .time-header strong {
            color: #667eea;
        }

        .time-edit-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            letter-spacing: 0.5px;
        }

        .time-edit-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
            background: linear-gradient(135deg, #20c997 0%, #28a745 100%);
        }

        ul {
            list-style: none;
            padding: 0;
        }
        li {
            padding: 12px;
            margin: 8px 0;
            background: linear-gradient(135deg, #fff 0%, #f8f9ff 100%);
            border: 2px solid transparent;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            animation: fadeInItem 0.5s ease-out both;
        }
        
        li:nth-child(1) { animation-delay: 0.1s; }
        li:nth-child(2) { animation-delay: 0.2s; }
        li:nth-child(3) { animation-delay: 0.3s; }
        li:nth-child(4) { animation-delay: 0.4s; }
        li:nth-child(5) { animation-delay: 0.5s; }
        li:nth-child(6) { animation-delay: 0.6s; }
        
        li {
            position: relative;
            overflow: hidden;
        }
        
        li::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }
        
        li:hover::before {
            left: 100%;
        }
        
        li:hover {
            transform: translateX(5px) scale(1.02);
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            background: linear-gradient(135deg, #fff 0%, #e8f2ff 100%);
        }
        
        @keyframes fadeInItem {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        .footer {
            text-align: center;
            font-weight: bold;
            margin-top: 50px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.95) 0%, rgba(118, 75, 162, 0.95) 100%);
            color: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 
                0 15px 40px rgba(102, 126, 234, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            animation: bounce 2s ease-in-out infinite;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 1.2em;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .footer:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 
                0 20px 50px rgba(102, 126, 234, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }

        /* Enhanced Portal Elements */
        .portal-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0;
            transition: opacity 1.5s ease;
        }

        .portal-elements.active {
            opacity: 1;
        }

        .floating-element {
            position: absolute;
            font-size: 2.5em;
            animation: floatAround 20s linear infinite;
            opacity: 0.4;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
        }

        .daycare-elements .floating-element:nth-child(1) { top: 10%; left: 10%; animation-delay: 0s; }
        .daycare-elements .floating-element:nth-child(2) { top: 20%; right: 15%; animation-delay: 5s; }
        .daycare-elements .floating-element:nth-child(3) { bottom: 30%; left: 20%; animation-delay: 10s; }
        .daycare-elements .floating-element:nth-child(4) { bottom: 20%; right: 10%; animation-delay: 15s; }

        .evening-elements .floating-element:nth-child(1) { top: 15%; left: 15%; animation-delay: 0s; }
        .evening-elements .floating-element:nth-child(2) { top: 25%; right: 20%; animation-delay: 6s; }
        .evening-elements .floating-element:nth-child(3) { bottom: 25%; left: 25%; animation-delay: 12s; }
        .evening-elements .floating-element:nth-child(4) { bottom: 15%; right: 15%; animation-delay: 18s; }

        .class-elements .floating-element:nth-child(1) { top: 12%; left: 12%; animation-delay: 0s; }
        .class-elements .floating-element:nth-child(2) { top: 22%; right: 18%; animation-delay: 7s; }
        .class-elements .floating-element:nth-child(3) { bottom: 28%; left: 22%; animation-delay: 14s; }
        .class-elements .floating-element:nth-child(4) { bottom: 18%; right: 12%; animation-delay: 21s; }

        @keyframes floatAround {
            0% { transform: translate(0, 0) rotate(0deg) scale(1); }
            25% { transform: translate(100px, -50px) rotate(90deg) scale(1.1); }
            50% { transform: translate(50px, -100px) rotate(180deg) scale(0.9); }
            75% { transform: translate(-50px, -50px) rotate(270deg) scale(1.1); }
            100% { transform: translate(0, 0) rotate(360deg) scale(1); }
        }

        /* Responsive Design Enhancements */
        @media (max-width: 900px) {
            .split-container {
                flex-direction: column;
            }
            .left-half, .right-half {
                width: 100vw;
                height: 40vh;
            }
            .right-half {
                height: auto;
                padding: 24px 4vw;
            }
            .main-emoji-container {
                gap: 30px;
            }
            .main-emoji-btn {
                min-width: 180px;
                padding: 30px 20px;
            }
            .emoji-display {
                font-size: 4.5em;
            }
            .emoji-label {
                font-size: 1.2em;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 10px;
            }
            .welcome-section {
                min-height: 150px;
                margin: 0 0 20px 0;
            }
            .content-section {
                padding: 20px;
            }
            .main-emoji-container {
                gap: 20px;
            }
            .main-emoji-btn {
                min-width: 150px;
                padding: 25px 15px;
            }
            .emoji-display {
                font-size: 4em;
            }
            .emoji-label {
                font-size: 1.1em;
            }
            .task-item {
                padding: 20px;
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
        }

        /* Subway Map Overlay Styles */
        #subway-map-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        #subway-map-overlay.active {
            opacity: 1;
        }

        .subway-map-container {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 249, 255, 0.95) 100%);
            border-radius: 25px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow: hidden;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: mapSlideIn 0.5s ease-out;
        }

        @keyframes mapSlideIn {
            from {
                transform: translateY(-50px) scale(0.9);
                opacity: 0;
            }
            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .subway-map-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 25px 25px 0 0;
        }

        .subway-map-header h2 {
            margin: 0;
            font-size: 1.8em;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .close-map-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 15px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-map-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .subway-map-content {
            padding: 30px;
            max-height: 60vh;
            overflow-y: auto;
        }

        .map-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .map-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.3);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        .map-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 30px rgba(40, 167, 69, 0.4);
            background: linear-gradient(135deg, #20c997 0%, #28a745 100%);
        }

        .subway-map-display {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            border: 1px solid rgba(102, 126, 234, 0.2);
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .map-placeholder {
            text-align: center;
            color: #2c3e50;
        }

        .map-icon {
            font-size: 4em;
            margin-bottom: 20px;
            animation: mapPulse 2s ease-in-out infinite;
        }

        @keyframes mapPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .map-placeholder h3 {
            font-size: 1.8em;
            margin-bottom: 15px;
            color: #667eea;
            font-weight: 700;
        }

        .map-placeholder p {
            font-size: 1.1em;
            margin-bottom: 25px;
            color: #555;
        }

        .quick-status {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 400px;
            margin: 0 auto;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            border: 1px solid rgba(102, 126, 234, 0.2);
            transition: all 0.3s ease;
        }

        .status-item:hover {
            transform: translateX(5px);
            background: rgba(255, 255, 255, 1);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .status-icon {
            font-size: 1.5em;
        }

        .map-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .map-update {
            text-align: center;
            color: #2c3e50;
        }

        .update-icon {
            font-size: 3em;
            margin-bottom: 15px;
            animation: updateSpin 1s ease-out;
        }

        @keyframes updateSpin {
            from { transform: rotate(0deg) scale(0.5); }
            to { transform: rotate(360deg) scale(1); }
        }

        .map-update h3 {
            font-size: 1.6em;
            margin-bottom: 10px;
            color: #667eea;
            font-weight: 700;
        }

        .map-update p {
            font-size: 1.1em;
            margin-bottom: 20px;
            color: #555;
        }

        .status-update {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .status-update p {
            margin: 8px 0;
            font-weight: 500;
        }

        .status-update strong {
            color: #667eea;
        }

        /* Pulse Animation */
        .emoji-pulse {
            animation: emojiPulseAuto 1s cubic-bezier(0.4, 0, 0.6, 1) 0s 3 alternate;
            box-shadow: 0 0 0 8px #ffe06688, 0 0 0 16px #667eea44;
        }
        @keyframes emojiPulseAuto {
            0% { transform: scale(1); }
            50% { transform: scale(1.15) rotate(-2deg); }
            100% { transform: scale(1); }
        }

        /* Add this helper to show the back-to-home button */
        function showBackToHomeButton() {
            if (document.getElementById('back-to-home-btn')) return; // Only one at a time
            const btn = document.createElement('button');
            btn.id = 'back-to-home-btn';
            btn.innerHTML = 'üè† Back to Home Portal';
            btn.onclick = function() {
                // Hide all sections and portals
                document.querySelectorAll('.section-content').forEach(section => section.classList.remove('active'));
                document.querySelectorAll('.portal-elements').forEach(portal => portal.classList.remove('active'));
                document.body.classList.remove('portal-daycare', 'portal-evening', 'portal-class');
                // Show main emoji screen
                document.getElementById('main-emoji-screen').classList.add('active');
                btn.remove();
                speak('Returned to home portal');
            };
            // Dismiss button
            const closeBtn = document.createElement('span');
            closeBtn.textContent = '√ó';
            closeBtn.style.marginLeft = '12px';
            closeBtn.style.cursor = 'pointer';
            closeBtn.onclick = function(e) { e.stopPropagation(); btn.remove(); };
            btn.appendChild(closeBtn);
            document.body.appendChild(btn);
        }

        /* Add CSS for the floating button */
        const backToHomeStyle = document.createElement('style');
        backToHomeStyle.textContent = `
        #back-to-home-btn {
            position: fixed;
            bottom: 32px;
            right: 32px;
            z-index: 99999;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 1.2em;
            font-weight: 600;
            border: none;
            border-radius: 30px;
            padding: 18px 32px;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.25);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4,0,0.6,1);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        #back-to-home-btn:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            transform: scale(1.05);
        }
        #back-to-home-btn span {
            font-size: 1.5em;
            margin-left: 8px;
        }
        `;
        document.head.appendChild(backToHomeStyle);
    </style>
</head>
<body>
    <!-- Floating particles -->
    <div class="particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>

    <!-- Portal Elements -->
    <div class="portal-elements active" id="daycare-portal">
        <div class="daycare-elements">
            <div class="floating-element">üßí</div>
            <div class="floating-element">üöó</div>
            <div class="floating-element">üçé</div>
            <div class="floating-element">üéí</div>
        </div>
    </div>

    <div class="portal-elements" id="evening-portal">
        <div class="evening-elements">
            <div class="floating-element">üåô</div>
            <div class="floating-element">‚≠ê</div>
            <div class="floating-element">üìñ</div>
            <div class="floating-element">üõèÔ∏è</div>
        </div>
    </div>

    <div class="portal-elements" id="class-portal">
        <div class="class-elements">
            <div class="floating-element">üìö</div>
            <div class="floating-element">‚úèÔ∏è</div>
            <div class="floating-element">üíª</div>
            <div class="floating-element">üéì</div>
        </div>
    </div>

    <div class="split-container">
        <div class="left-half" role="img" aria-label="Thrive Assistant Welcome" tabindex="0">
            <div class="welcome-content">
                <h2>Thrive Assistant</h2>
                <p>Your personal workflow companion for a balanced life</p>
                <div class="welcome-description">
                    <span>üë®‚Äçüë¶ Quality time with your little one starts here</span>
                </div>
            </div>
        </div>
        <main class="right-half" role="main" aria-label="Thrive Assistant Workflow" tabindex="0">
            <div class="header">
                <div class="header-top">
                    <h1 id="welcome-heading">Welcome, Hamed <span class="wave-emoji">üëã</span></h1>
                </div>
                <div class="date-time-container">
                    <div class="date-dropdown">
                        <p><strong>Today's Date:</strong> <span id="date"></span> <span class="sparkle">‚ú®</span> <button class="dropdown-arrow" onclick="toggleDateDropdown()">‚ñº</button></p>
                        <div id="date-dropdown-content" class="dropdown-content">
                            <input type="date" id="date-picker" onchange="changeDate(this.value)">
                            <button onclick="resetToToday()">Reset to Today</button>
                        </div>
                    </div>
                    <div class="time-dropdown">
                        <p><strong>Current Time:</strong> <span id="current-time"></span> <span class="time-sparkle">‚è∞</span> <button class="dropdown-arrow" onclick="toggleTimeDropdown()">‚ñº</button></p>
                        <div id="time-dropdown-content" class="dropdown-content">
                            <input type="time" id="time-picker" onchange="changeTime(this.value)">
                            <button onclick="resetToCurrentTime()">Reset to Current Time</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Emoji Screen -->
            <div id="main-emoji-screen" class="main-emoji-screen active">
                <h2>Choose Your Portal</h2>
                <div class="main-emoji-container">
                    <button class="main-emoji-btn" onclick="showSection('daycare')" aria-label="Daycare Pickup">
                        <div class="emoji-display">üßí</div>
                        <div class="emoji-label">Daycare Pickup</div>
                    </button>
                    <button class="main-emoji-btn" onclick="showSection('evening')" aria-label="Evening Routine">
                        <div class="emoji-display">üåô</div>
                        <div class="emoji-label">Evening Routine</div>
                    </button>
                    <button class="main-emoji-btn" onclick="showSection('class')" aria-label="Class Prep">
                        <div class="emoji-display">üìö</div>
                        <div class="emoji-label">Class Prep</div>
                    </button>
                </div>
            </div>

            <!-- Daycare Pickup Section -->
            <div id="daycare-section" class="section-content">
                <div class="section-header">
                    <div class="header-top">
                        <button class="back-btn" onclick="backToMain()">‚Üê Back to Main</button>
                        <h2>üßí Daycare Pickup</h2>
                    </div>
                    <div class="time-header">
                        <p><strong>Time:</strong> <span id="daycare-time">5:00 PM</span></p>
                        <button class="time-edit-btn" onclick="editTime('daycare')">‚è∞ Edit Time</button>
                    </div>
                </div>
                
                <!-- Daycare Tasks -->
                <div class="task-list">
                    <!-- Tasks moved to sub-directory -->
                </div>
                
                <!-- Sub-task Folders -->
                <div class="sub-task-folders">
                    <div class="sub-task-folder" onclick="openSubTask('daycare', 'traffic')">
                        <div class="folder-icon">üöó</div>
                        <div class="folder-info">
                            <h3>Check Traffic</h3>
                            <p class="task-time">4:45 PM</p>
                        </div>
                        <div class="folder-arrow">‚Üí</div>
                    </div>
                    
                    <div class="sub-task-folder" onclick="openSubTask('daycare', 'signout', event)">
                        <div class="folder-icon">üè¢</div>
                        <div class="folder-info">
                            <h3>Signout from Office</h3>
                            <p class="task-time">4:50 PM</p>
                        </div>
                        <!-- No folder-arrow here -->
                    </div>
                    
                    <div class="sub-task-folder" onclick="openSubTask('daycare', 'taxi')">
                        <div class="folder-icon">üöï</div>
                        <div class="folder-info">
                            <h3>Taxi</h3>
                            <p class="task-time">4:55 PM</p>
                        </div>
                        <div class="folder-arrow">‚Üí</div>
                    </div>
                </div>
            </div>


            <!-- Evening Routine Section -->
            <div id="evening-section" class="section-content">
                <div class="section-header">
                    <div class="header-top">
                        <button class="back-btn" onclick="backToMain()">‚Üê Back to Main</button>
                        <h2>üåô Evening Routine with [Son's Name]</h2>
                    </div>
                    <div class="time-header">
                        <p><strong>Time:</strong> <span id="evening-time">6:30 PM</span></p>
                        <button class="time-edit-btn" onclick="editTime('evening')">‚è∞ Edit Time</button>
                    </div>
                </div>
                
                <!-- Evening Tasks -->
                <div class="task-list">
                    <div class="task-item">
                        <span class="task-time" onclick="editTaskTime(this, 'evening', 'dinner')">6:30 PM</span> ‚Äî Eat dinner 
                        <button class="speak-btn" aria-label="Speak: Dinner time for your little one." onclick="speak(`Dinner time for your little one.`)">üîä</button>
                    </div>
                    <div class="task-item">
                        <span class="task-time" onclick="editTaskTime(this, 'evening', 'teeth')">7:00 PM</span> ‚Äî Brush teeth 
                        <button class="speak-btn" aria-label="Speak: Brush his teeth and smile." onclick="speak(`Brush his teeth and smile.`)">üîä</button>
                    </div>
                    <div class="task-item">
                        <span class="task-time" onclick="editTaskTime(this, 'evening', 'storytime')">7:10 PM</span> ‚Äî Storytime 
                        <button class="speak-btn" aria-label="Speak: Enjoy storytime together." onclick="speak(`Enjoy storytime together.`)">üîä</button>
                    </div>
                    <div class="task-item">
                        <span class="task-time" onclick="editTaskTime(this, 'evening', 'pack')">7:30 PM</span> ‚Äî Pack for tomorrow 
                        <button class="speak-btn" aria-label="Speak: Pack his bag for tomorrow." onclick="speak(`Pack his bag for tomorrow.`)">üîä</button>
                    </div>
                </div>
            </div>

            <!-- Class Prep Section -->
            <div id="class-section" class="section-content">
                <div class="section-header">
                    <div class="header-top">
                        <button class="back-btn" onclick="backToMain()">‚Üê Back to Main</button>
                        <h2>üìö Class Prep</h2>
                    </div>
                    <div class="time-header">
                        <p><strong>Time:</strong> <span id="class-time">6:00 PM</span></p>
                        <button class="time-edit-btn" onclick="editTime('class')">‚è∞ Edit Time</button>
                    </div>
                </div>
                
                <!-- Class Prep Tasks -->
                <div class="task-list">
                    <div class="task-item">
                        <span class="task-time" onclick="editTaskTime(this, 'class', 'laptop')">6:00 PM</span> ‚Äî Pack laptop 
                        <button class="speak-btn" aria-label="Speak: Pack your laptop for class." onclick="speak(`Pack your laptop for class.`)">üîä</button>
                    </div>
                    <div class="task-item">
                        <span class="task-time" onclick="editTaskTime(this, 'class', 'slack')">6:05 PM</span> ‚Äî Check Slack messages 
                        <button class="speak-btn" aria-label="Speak: Check your Slack messages and task tab." onclick="speak(`Check your Slack messages and task tab.`)">üîä</button>
                    </div>
                    <div class="task-item">
                        <span class="task-time" onclick="editTaskTime(this, 'class', 'materials')">6:10 PM</span> ‚Äî Class materials 
                        <button class="speak-btn" aria-label="Speak: Review your class handouts and materials." onclick="speak(`Review your class handouts and materials.`)">üîä</button>
                    </div>
                    <div class="task-item">
                        <span class="task-time" onclick="editTaskTime(this, 'class', 'charger')">6:15 PM</span> ‚Äî Charger 
                        <button class="speak-btn" aria-label="Speak: Bring your charger." onclick="speak(`Bring your charger.`)">üîä</button>
                    </div>
                </div>
            </div>

            <!-- Sub-task Detail Views -->
            <div id="sub-task-details" class="sub-task-detail">
                <!-- Daycare Sub-tasks -->
                <div id="daycare-traffic-detail" class="sub-task-detail">
                    <div class="detail-header">
                        <h2>üöó Check Traffic</h2>
                        <button class="back-btn" onclick="closeSubTask()">‚Üê Back</button>
                    </div>
                    <div class="task-content">
                        <p><strong>Time:</strong> <span class="task-time" onclick="editTaskTime(this, 'daycare', 'traffic')">4:45 PM</span></p>
                        <p><strong>Description:</strong> Check traffic conditions for your daycare pickup route</p>
                        <div class="task-actions">
                            <button class="action-btn" onclick="speak('It\'s time to check the traffic for your daycare pickup.')">üîä Speak</button>
                            <button class="action-btn" onclick="markComplete('daycare', 'traffic')">‚úÖ Complete</button>
                        </div>
                    </div>
                </div>

                <div id="daycare-signout-detail" class="sub-task-detail">
                    <div class="detail-header">
                        <h2>üè¢ Signout from Office</h2>
                        <button class="back-btn" onclick="closeSubTask()">‚Üê Back</button>
                    </div>
                    <div class="task-content">
                        <p><strong>Time:</strong> <span class="task-time" onclick="editTaskTime(this, 'daycare', 'signout')">4:50 PM</span></p>
                        <p><strong>Description:</strong> Sign out from the office and prepare to leave</p>
                        <div class="task-actions">
                            <button class="action-btn" onclick="speak('Sign out from the office and prepare to leave.')">üîä Speak</button>
                            <button class="action-btn" onclick="markComplete('daycare', 'signout')">‚úÖ Complete</button>
                        </div>
                    </div>
                </div>

                <div id="daycare-taxi-detail" class="sub-task-detail">
                    <div class="detail-header">
                        <h2>üöï Taxi</h2>
                        <button class="back-btn" onclick="closeSubTask()">‚Üê Back</button>
                    </div>
                    <div class="task-content">
                        <p><strong>Time:</strong> <span class="task-time" onclick="editTaskTime(this, 'daycare', 'taxi')">4:55 PM</span></p>
                        <p><strong>Description:</strong> Book or call your taxi for daycare pickup</p>
                        <div class="task-actions">
                            <button class="action-btn" onclick="speak('Book or call your taxi for daycare pickup.')">üîä Speak</button>
                            <button class="action-btn" onclick="markComplete('daycare', 'taxi')">‚úÖ Complete</button>
                        </div>
                    </div>
                </div>

                <!-- Evening Sub-tasks -->
                <div id="evening-dinner-detail" class="sub-task-detail">
                    <div class="detail-header">
                        <h2>üçΩÔ∏è Eat Dinner</h2>
                        <button class="back-btn" onclick="closeSubTask()">‚Üê Back</button>
                    </div>
                    <div class="task-content">
                        <p><strong>Time:</strong> <span class="task-time" onclick="editTaskTime(this, 'evening', 'dinner')">6:30 PM</span></p>
                        <p><strong>Description:</strong> Dinner time for your little one</p>
                        <div class="task-actions">
                            <button class="action-btn" onclick="speak('Dinner time for your little one.')">üîä Speak</button>
                            <button class="action-btn" onclick="markComplete('evening', 'dinner')">‚úÖ Complete</button>
                        </div>
                    </div>
                </div>

                <div id="evening-teeth-detail" class="sub-task-detail">
                    <div class="detail-header">
                        <h2>ü¶∑ Brush Teeth</h2>
                        <button class="back-btn" onclick="closeSubTask()">‚Üê Back</button>
                    </div>
                    <div class="task-content">
                        <p><strong>Time:</strong> <span class="task-time" onclick="editTaskTime(this, 'evening', 'teeth')">7:00 PM</span></p>
                        <p><strong>Description:</strong> Brush his teeth and smile</p>
                        <div class="task-actions">
                            <button class="action-btn" onclick="speak('Brush his teeth and smile.')">üîä Speak</button>
                            <button class="action-btn" onclick="markComplete('evening', 'teeth')">‚úÖ Complete</button>
                        </div>
                    </div>
                </div>

                <div id="evening-storytime-detail" class="sub-task-detail">
                    <div class="detail-header">
                        <h2>üìñ Storytime</h2>
                        <button class="back-btn" onclick="closeSubTask()">‚Üê Back</button>
                    </div>
                    <div class="task-content">
                        <p><strong>Time:</strong> <span class="task-time" onclick="editTaskTime(this, 'evening', 'storytime')">7:10 PM</span></p>
                        <p><strong>Description:</strong> Enjoy storytime together</p>
                        <div class="task-actions">
                            <button class="action-btn" onclick="speak('Enjoy storytime together.')">üîä Speak</button>
                            <button class="action-btn" onclick="markComplete('evening', 'storytime')">‚úÖ Complete</button>
                        </div>
                    </div>
                </div>

                <div id="evening-pack-detail" class="sub-task-detail">
                    <div class="detail-header">
                        <h2>üéí Pack for Tomorrow</h2>
                        <button class="back-btn" onclick="closeSubTask()">‚Üê Back</button>
                    </div>
                    <div class="task-content">
                        <p><strong>Time:</strong> <span class="task-time" onclick="editTaskTime(this, 'evening', 'pack')">7:30 PM</span></p>
                        <p><strong>Description:</strong> Pack his bag for tomorrow</p>
                        <div class="task-actions">
                            <button class="action-btn" onclick="speak('Pack his bag for tomorrow.')">üîä Speak</button>
                            <button class="action-btn" onclick="markComplete('evening', 'pack')">‚úÖ Complete</button>
                        </div>
                    </div>
                </div>

                <!-- Class Prep Sub-tasks -->
                <div id="class-laptop-detail" class="sub-task-detail">
                    <div class="detail-header">
                        <h2>üíª Pack Laptop</h2>
                        <button class="back-btn" onclick="closeSubTask()">‚Üê Back</button>
                    </div>
                    <div class="task-content">
                        <p><strong>Time:</strong> <span class="task-time" onclick="editTaskTime(this, 'class', 'laptop')">6:00 PM</span></p>
                        <p><strong>Description:</strong> Pack your laptop for class</p>
                        <div class="task-actions">
                            <button class="action-btn" onclick="speak('Pack your laptop for class.')">üîä Speak</button>
                            <button class="action-btn" onclick="markComplete('class', 'laptop')">‚úÖ Complete</button>
                        </div>
                    </div>
                </div>

                <div id="class-slack-detail" class="sub-task-detail">
                    <div class="detail-header">
                        <h2>üí¨ Check Slack Messages</h2>
                        <button class="back-btn" onclick="closeSubTask()">‚Üê Back</button>
                    </div>
                    <div class="task-content">
                        <p><strong>Time:</strong> <span class="task-time" onclick="editTaskTime(this, 'class', 'slack')">6:05 PM</span></p>
                        <p><strong>Description:</strong> Check your Slack messages and task tab</p>
                        <div class="task-actions">
                            <button class="action-btn" onclick="speak('Check your Slack messages and task tab.')">üîä Speak</button>
                            <button class="action-btn" onclick="markComplete('class', 'slack')">‚úÖ Complete</button>
                        </div>
                    </div>
                </div>

                <div id="class-materials-detail" class="sub-task-detail">
                    <div class="detail-header">
                        <h2>üìã Class Materials</h2>
                        <button class="back-btn" onclick="closeSubTask()">‚Üê Back</button>
                    </div>
                    <div class="task-content">
                        <p><strong>Time:</strong> <span class="task-time" onclick="editTaskTime(this, 'class', 'materials')">6:10 PM</span></p>
                        <p><strong>Description:</strong> Review your class handouts and materials</p>
                        <div class="task-actions">
                            <button class="action-btn" onclick="speak('Review your class handouts and materials.')">üîä Speak</button>
                            <button class="action-btn" onclick="markComplete('class', 'materials')">‚úÖ Complete</button>
                        </div>
                    </div>
                </div>

                <div id="class-charger-detail" class="sub-task-detail">
                    <div class="detail-header">
                        <h2>üîå Charger</h2>
                        <button class="back-btn" onclick="closeSubTask()">‚Üê Back</button>
                    </div>
                    <div class="task-content">
                        <p><strong>Time:</strong> <span class="task-time" onclick="editTaskTime(this, 'class', 'charger')">6:15 PM</span></p>
                        <p><strong>Description:</strong> Bring your charger</p>
                        <div class="task-actions">
                            <button class="action-btn" onclick="speak('Bring your charger.')">üîä Speak</button>
                            <button class="action-btn" onclick="markComplete('class', 'charger')">‚úÖ Complete</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer" aria-label="All done message" onclick="celebrate()">
                üéâ All done! Have a smooth and happy evening! üéâ
            </div>
        </main>
    </div>
    <script>
        // Date management
        let selectedDate = new Date();
        
        // Update the date and time display
        function updateDate() {
            document.getElementById("date").textContent = selectedDate.toLocaleDateString('en-US', {
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
            });
            
            // Update current time
            const now = new Date();
            document.getElementById("current-time").textContent = now.toLocaleTimeString('en-US', {
                hour: 'numeric',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });
        }
        
        // Dropdown functionality for date and time
        function toggleDateDropdown() {
            const dropdown = document.getElementById('date-dropdown-content');
            const timeDropdown = document.getElementById('time-dropdown-content');
            
            // Close time dropdown if open
            timeDropdown.classList.remove('show');
            
            // Toggle date dropdown
            dropdown.classList.toggle('show');
            
            // Set current date in picker
            if (dropdown.classList.contains('show')) {
                document.getElementById('date-picker').value = selectedDate.toISOString().split('T')[0];
            }
        }

        function toggleTimeDropdown() {
            const dropdown = document.getElementById('time-dropdown-content');
            const dateDropdown = document.getElementById('date-dropdown-content');
            
            // Close date dropdown if open
            dateDropdown.classList.remove('show');
            
            // Toggle time dropdown
            dropdown.classList.toggle('show');
            
            // Set current time in picker
            if (dropdown.classList.contains('show')) {
                const now = new Date();
                const timeString = now.toTimeString().slice(0, 5);
                document.getElementById('time-picker').value = timeString;
            }
        }

        function changeDate(newDateStr) {
            const newDate = new Date(newDateStr);
            if (newDate && !isNaN(newDate.getTime())) {
                selectedDate = newDate;
                updateDate();
                saveDateSettings();
                speak(`Date changed to ${selectedDate.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}`);
                
                // Close dropdown
                document.getElementById('date-dropdown-content').classList.remove('show');
            }
        }

        function changeTime(newTimeStr) {
            const [hours, minutes] = newTimeStr.split(':');
            const now = new Date();
            now.setHours(parseInt(hours), parseInt(minutes), 0, 0);
            
            // Update the current time display
            document.getElementById("current-time").textContent = now.toLocaleTimeString('en-US', {
                hour: 'numeric',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });
            
            speak(`Time changed to ${now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true })}`);
            
            // Close dropdown
            document.getElementById('time-dropdown-content').classList.remove('show');
        }

        function resetToToday() {
            selectedDate = new Date();
            updateDate();
            saveDateSettings();
            speak('Date reset to today');
            
            // Close dropdown
            document.getElementById('date-dropdown-content').classList.remove('show');
        }

        function resetToCurrentTime() {
            const now = new Date();
            document.getElementById("current-time").textContent = now.toLocaleTimeString('en-US', {
                hour: 'numeric',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });
            // Also update selectedDate to today (if needed)
            selectedDate = new Date();
            speak('Time reset to current time');
            // Close dropdown
            document.getElementById('time-dropdown-content').classList.remove('show');
            // Immediately check reminders with the new time
            checkTaskReminders();
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            const dateDropdown = document.getElementById('date-dropdown-content');
            const timeDropdown = document.getElementById('time-dropdown-content');
            
            if (!event.target.closest('.date-dropdown') && !event.target.closest('.time-dropdown')) {
                dateDropdown.classList.remove('show');
                timeDropdown.classList.remove('show');
            }
        });
        
        // Save date settings to localStorage
        function saveDateSettings() {
            localStorage.setItem('thriveSelectedDate', selectedDate.toISOString());
        }
        
        // Load date settings from localStorage
        function loadDateSettings() {
            const savedDate = localStorage.getItem('thriveSelectedDate');
            if (savedDate) {
                const parsedDate = new Date(savedDate);
                if (!isNaN(parsedDate.getTime())) {
                    selectedDate = parsedDate;
                }
            }
            updateDate();
        }
        
        // Initialize date
        loadDateSettings();
        setInterval(updateDate, 60000); // Update every minute

        // Section switching functionality
        function showSection(sectionName) {
            // Hide main emoji screen
            document.getElementById('main-emoji-screen').classList.remove('active');
            
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.remove('active');
            });
            
            // Hide all portal elements
            document.querySelectorAll('.portal-elements').forEach(portal => {
                portal.classList.remove('active');
            });
            
            // Remove portal classes from body
            document.body.classList.remove('portal-daycare', 'portal-evening', 'portal-class');
            
            // Show selected section
            document.getElementById(sectionName + '-section').classList.add('active');
            
            // Change portal environment
            document.body.classList.add('portal-' + sectionName);
            document.getElementById(sectionName + '-portal').classList.add('active');
            
            // Add visual feedback
            event.target.style.transform = 'scale(0.95)';
            setTimeout(() => {
                event.target.style.transform = '';
            }, 200);
            
            // Speak the section name
            const sectionNames = {
                'daycare': 'Daycare Pickup',
                'evening': 'Evening Routine',
                'class': 'Class Prep'
            };
            speak(`Welcome to the ${sectionNames[sectionName]} portal`);
        }

        // Back to main screen functionality
        function backToMain() {
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.remove('active');
            });
            
            // Hide all portal elements
            document.querySelectorAll('.portal-elements').forEach(portal => {
                portal.classList.remove('active');
            });
            
            // Remove portal classes from body
            document.body.classList.remove('portal-daycare', 'portal-evening', 'portal-class');
            
            // Show main emoji screen
            document.getElementById('main-emoji-screen').classList.add('active');
            
            speak('Returning to main menu');
        }

        // Sub-task functionality
        function openSubTask(section, task, event) {
            // If this is the traffic check, open Google Maps immediately
            if (section === 'daycare' && task === 'traffic') {
                window.open('https://www.google.com/maps/dir/?api=1&origin=Your+Office&destination=Daycare+Center&travelmode=driving&layer=traffic', '_blank');
                showBackToHomeButton();
            }
            // If this is the taxi tab, open Uber in a new tab
            if (section === 'daycare' && task === 'taxi') {
                window.open('https://m.uber.com/', '_blank');
                showBackToHomeButton();
            }
            // Hide all section content
            document.querySelectorAll('.section-content').forEach(section => {
                section.style.display = 'none';
            });
            
            // Hide sub-task folders
            document.querySelectorAll('.sub-task-folders').forEach(folder => {
                folder.style.display = 'none';
            });
            
            // Show the specific sub-task detail
            const detailId = `${section}-${task}-detail`;
            document.getElementById(detailId).classList.add('active');
            
            // Add visual feedback
            if (event && event.target) {
                event.target.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    event.target.style.transform = '';
                }, 200);
            }
            
            // Speak the task name
            const taskNames = {
                'traffic': 'Check Traffic',
                'essentials': 'Grab Essentials', 
                'snack': 'Prepare Snack',
                'dinner': 'Eat Dinner',
                'teeth': 'Brush Teeth',
                'storytime': 'Storytime',
                'pack': 'Pack for Tomorrow',
                'notebook': 'Notebook',
                'pens': 'Pens',
                'water': 'Water Bottle',
                'materials': 'Class Materials',
                'charger': 'Charger',
                'signout': 'Signout from Office',
                'taxi': 'Taxi',
                'laptop': 'Pack Laptop',
                'slack': 'Check Slack Messages'
            };
            speak(`Opening ${taskNames[task]} task`);
        }

        function closeSubTask() {
            // Hide all sub-task details
            document.querySelectorAll('.sub-task-detail').forEach(detail => {
                detail.classList.remove('active');
            });
            
            // Show the current section content
            const activeSection = document.querySelector('.section-content.active');
            if (activeSection) {
                activeSection.style.display = 'block';
            }
            
            // Show sub-task folders
            document.querySelectorAll('.sub-task-folders').forEach(folder => {
                folder.style.display = 'grid';
            });
            
            speak('Returning to task overview');
        }

        function markComplete(section, task) {
            // Add visual feedback
            const detailElement = document.getElementById(`${section}-${task}-detail`);
            detailElement.style.background = 'linear-gradient(135deg, #28a745 0%, #20c997 100%)';
            detailElement.style.color = 'white';
            
            // Show completion message
            speak(`Great job! ${task} completed successfully!`);
            
            // Add confetti effect
            createConfetti();
            
            // Reset after a delay
            setTimeout(() => {
                detailElement.style.background = '';
                detailElement.style.color = '';
            }, 2000);
        }
        
        // Real-time task reminder system
        let reminderCheckInterval;
        let lastRemindedTasks = new Set();
        
        function startReminderSystem() {
            // Check for reminders every 30 seconds
            reminderCheckInterval = setInterval(checkTaskReminders, 30000);
            
            // Also check immediately when page loads
            checkTaskReminders();
        }
        
        function checkTaskReminders() {
            const now = new Date();
            // Normalize current time to match display (e.g., '4:45 PM')
            let currentTime = now.toLocaleTimeString('en-US', {
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            }).replace(/^0+/, '').replace(/\s+/g, ' ').trim();

            // Reset reminders at midnight
            if (now.getHours() === 0 && now.getMinutes() === 0) {
                lastRemindedTasks.clear();
            }

            // Check all task times (main and sub-task)
            document.querySelectorAll('.task-time').forEach(timeElement => {
                // Normalize the task time string
                const taskTime = timeElement.textContent.trim().replace(/^0+/, '').replace(/\s+/g, ' ');
                // Try to get the task name from the parent (main or sub-task)
                let taskName = '';
                // For main task list
                if (timeElement.parentElement && timeElement.parentElement.textContent.includes('‚Äî')) {
                    taskName = timeElement.parentElement.textContent.split('‚Äî')[1].trim();
                } else {
                    // For sub-task detail, try to get from header or fallback
                    const detail = timeElement.closest('.sub-task-detail');
                    if (detail) {
                        const h2 = detail.querySelector('h2');
                        if (h2) taskName = h2.textContent.trim();
                    }
                }
                const taskKey = `${taskName}-${taskTime}`;
                // Check if it's time for this task and we haven't reminded yet
                if (taskTime === currentTime && !lastRemindedTasks.has(taskKey)) {
                    triggerTaskReminder(taskName, taskTime, timeElement);
                    lastRemindedTasks.add(taskKey);
                }
            });
        }
        
        // Helper: get the emoji button for a portal
        function getEmojiBtnForPortal(portal) {
            const portalIndex = { 'daycare': 0, 'evening': 1, 'class': 2 };
            const idx = portalIndex[portal];
            const emojiBtns = document.querySelectorAll('.main-emoji-btn');
            return emojiBtns[idx] || null;
        }

        // Enhance triggerTaskReminder to simulate emoji click for full effect
        function triggerTaskReminder(taskName, taskTime, timeElement) {
            // Visual notification
            timeElement.style.background = 'rgba(255, 107, 107, 0.3)';
            timeElement.style.borderColor = '#ff6b6b';
            timeElement.style.animation = 'reminderPulse 1s ease-in-out infinite';
            
            // Voice reminder
            const reminderMessage = `It's ${taskTime}, time to ${taskName.toLowerCase()}`;
            speak(reminderMessage);

            // --- Auto-navigate to portal and simulate emoji click ---
            // Map task keywords to portal
            const portalMap = {
                'traffic': 'daycare',
                'signout': 'daycare',
                'taxi': 'daycare',
                'dinner': 'evening',
                'teeth': 'evening',
                'storytime': 'evening',
                'pack': 'evening',
                'laptop': 'class',
                'slack': 'class',
                'materials': 'class',
                'charger': 'class'
            };
            // Find the portal for this task
            let portal = null;
            for (const key in portalMap) {
                if (taskName.toLowerCase().includes(key)) {
                    portal = portalMap[key];
                    break;
                }
            }
            if (portal) {
                setTimeout(() => {
                    // Simulate emoji click for full effect
                    const emojiBtn = getEmojiBtnForPortal(portal);
                    if (emojiBtn) {
                        // Pulse the emoji
                        emojiBtn.classList.add('emoji-pulse');
                        setTimeout(() => {
                            emojiBtn.classList.remove('emoji-pulse');
                        }, 3000);
                        // Open the portal and play the same audio as a manual click
                        showSection(portal);
                        // Speak the same welcome as a manual click
                        const portalNames = {
                            'daycare': 'Welcome to the Daycare Pickup portal',
                            'evening': 'Welcome to the Evening Routine portal',
                            'class': 'Welcome to the Class Prep portal'
                        };
                        speak(portalNames[portal]);
                    } else {
                        // Fallback: just open the portal and speak
                        showSection(portal);
                        speak(`Welcome to the ${portal} portal`);
                    }
                }, 2000); // Wait 2 seconds after the initial reminder
            }

            // Special handling for traffic check - open subway map and Google Maps automatically
            if (taskName.toLowerCase().includes('traffic') || taskName.toLowerCase().includes('check traffic')) {
                setTimeout(() => {
                    speak("Opening subway map and Google Maps for traffic check");
                    openSubwayMap();
                    window.open('https://www.google.com/maps/dir/?api=1&origin=Your+Office&destination=Daycare+Center&travelmode=driving&layer=traffic', '_blank');
                }, 4000); // Wait 4 seconds after the initial reminder
            }
            
            // Show browser notification if supported
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('Thrive Assistant Reminder', {
                    body: reminderMessage,
                    icon: 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><circle cx=\"50\" cy=\"50\" r=\"45\" fill=\"%23667eea\"/><text x=\"50\" y=\"60\" text-anchor=\"middle\" fill=\"white\" font-size=\"40\">‚è∞</text></svg>',
                    badge: 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><circle cx=\"50\" cy=\"50\" r=\"45\" fill=\"%23ff6b6b\"/><text x=\"50\" y=\"60\" text-anchor=\"middle\" fill=\"white\" font-size=\"40\">üîî</text></svg>'
                });
            }
            
            // Create floating notification
            createFloatingNotification(taskName, taskTime);
            
            // Reset visual effect after 10 seconds
            setTimeout(() => {
                timeElement.style.background = 'rgba(102, 126, 234, 0.1)';
                timeElement.style.borderColor = 'transparent';
                timeElement.style.animation = 'timeGlow 2s ease-in-out infinite alternate';
            }, 10000);
        }
        
        function createFloatingNotification(taskName, taskTime) {
            const notification = document.createElement('div');
            notification.className = 'floating-notification';
            notification.innerHTML = `
                <div class="notification-content">
                    <span class="notification-icon">‚è∞</span>
                    <div class="notification-text">
                        <div class="notification-time">${taskTime}</div>
                        <div class="notification-task">${taskName}</div>
                    </div>
                    <button class="notification-close" onclick="this.parentElement.parentElement.remove()">√ó</button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto-remove after 15 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 15000);
        }
        
        // Request notification permission
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }

        // Voice reminder function
        function speak(text) {
            const msg = new SpeechSynthesisUtterance();
            msg.text = text;
            msg.lang = 'en-US';
            window.speechSynthesis.speak(msg);
        }

        // Time editing functionality
        function editTime(section) {
            const timeElement = document.getElementById(section + '-time');
            const currentTime = timeElement.textContent;
            
            // Create a simple time picker
            const newTime = prompt(`Enter new time for ${section} (e.g., 5:00 PM):`, currentTime);
            
            if (newTime && newTime.trim() !== '') {
                timeElement.textContent = newTime.trim();
                saveTimeSettings();
                speak(`Time updated for ${section} to ${newTime}`);
            }
        }
        
        // Task time editing functionality
        function editTaskTime(timeElement, section, task) {
            const currentTime = timeElement.textContent;
            // Use the task name from mapping for prompt
            const taskNames = {
                'traffic': 'Check Traffic',
                'signout': 'Signout from Office',
                'taxi': 'Taxi',
                'dinner': 'Eat Dinner',
                'teeth': 'Brush Teeth',
                'storytime': 'Storytime',
                'pack': 'Pack for Tomorrow',
                'laptop': 'Pack Laptop',
                'slack': 'Check Slack Messages',
                'materials': 'Class Materials',
                'charger': 'Charger'
            };
            const taskName = taskNames[task] || task;
            // Prompt for new time
            const newTime = prompt(`Enter new time for ${taskName} (e.g., 5:00 PM):`, currentTime);
            if (newTime && newTime.trim() !== '') {
                // Update all .task-time for this section/task
                document.querySelectorAll(`.task-time`).forEach(el => {
                    // Check if this .task-time belongs to the same section/task
                    const parent = el.closest('.sub-task-detail, .task-item, li');
                    if (parent && (
                        (parent.id && parent.id.includes(`${section}-${task}`)) ||
                        (el.getAttribute('onclick') && el.getAttribute('onclick').includes(`'${section}'`) && el.getAttribute('onclick').includes(`'${task}'`))
                    )) {
                        el.textContent = newTime.trim();
                    }
                });
                saveTaskTimeSettings();
                speak(`Time updated for ${taskName} to ${newTime}`);
                // Add visual feedback
                timeElement.style.background = 'rgba(40, 167, 69, 0.2)';
                timeElement.style.borderColor = '#28a745';
                setTimeout(() => {
                    timeElement.style.background = 'rgba(102, 126, 234, 0.1)';
                    timeElement.style.borderColor = 'transparent';
                }, 1000);
            }
        }

        // Save time settings to localStorage
        function saveTimeSettings() {
            const timeSettings = {
                daycare: document.getElementById('daycare-time').textContent,
                class: document.getElementById('class-time').textContent,
                evening: document.getElementById('evening-time').textContent
            };
            localStorage.setItem('thriveTimeSettings', JSON.stringify(timeSettings));
        }

        // Save task time settings to localStorage
        function saveTaskTimeSettings() {
            const taskTimes = {};
            document.querySelectorAll('.task-time').forEach(timeElement => {
                const taskName = timeElement.parentElement.textContent.split('‚Äî')[1].trim();
                taskTimes[taskName] = timeElement.textContent;
            });
            localStorage.setItem('thriveTaskTimeSettings', JSON.stringify(taskTimes));
        }
        
        // Load time settings from localStorage
        function loadTimeSettings() {
            const savedSettings = localStorage.getItem('thriveTimeSettings');
            if (savedSettings) {
                const timeSettings = JSON.parse(savedSettings);
                Object.keys(timeSettings).forEach(section => {
                    const element = document.getElementById(section + '-time');
                    if (element) {
                        element.textContent = timeSettings[section];
                    }
                });
            }
            
            // Load task time settings
            const savedTaskSettings = localStorage.getItem('thriveTaskTimeSettings');
            if (savedTaskSettings) {
                const taskTimeSettings = JSON.parse(savedTaskSettings);
                document.querySelectorAll('.task-time').forEach(timeElement => {
                    const taskName = timeElement.parentElement.textContent.split('‚Äî')[1].trim();
                    if (taskTimeSettings[taskName]) {
                        timeElement.textContent = taskTimeSettings[taskName];
                    }
                });
            }
        }

        // Subway Map functionality
        function openSubwayMap() {
            // Create subway map overlay
            const subwayMapOverlay = document.createElement('div');
            subwayMapOverlay.id = 'subway-map-overlay';
            subwayMapOverlay.innerHTML = `
                <div class="subway-map-container">
                    <div class="subway-map-header">
                        <h2>üöá Subway Map - Traffic Check</h2>
                        <button class="close-map-btn" onclick="closeSubwayMap()">‚úï</button>
                    </div>
                    <div class="subway-map-content">
                        <div class="map-controls">
                            <button class="map-btn" onclick="checkSubwayStatus('real-time')">üöá Real-time Status</button>
                            <button class="map-btn" onclick="checkSubwayStatus('delays')">‚ö†Ô∏è Check Delays</button>
                            <button class="map-btn" onclick="checkSubwayStatus('routes')">üó∫Ô∏è Route Planner</button>
                            <button class="map-btn" onclick="checkSubwayStatus('alerts')">üö® Service Alerts</button>
                        </div>
                        <div class="subway-map-display">
                            <div class="map-placeholder">
                                <div class="map-icon">üöá</div>
                                <h3>Subway Traffic Information</h3>
                                <p>Click any button above to check specific subway information</p>
                                <div class="quick-status">
                                    <div class="status-item">
                                        <span class="status-icon">üü¢</span>
                                        <span>Green Line: Normal</span>
                                    </div>
                                    <div class="status-item">
                                        <span class="status-icon">üü°</span>
                                        <span>Yellow Line: Minor Delays</span>
                                    </div>
                                    <div class="status-item">
                                        <span class="status-icon">üî¥</span>
                                        <span>Red Line: Check Status</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="map-actions">
                            <button class="action-btn" onclick="speak('Subway traffic check completed. Safe travels!')">‚úÖ Mark Complete</button>
                            <button class="action-btn" onclick="closeSubwayMap()">üîô Close Map</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(subwayMapOverlay);
            
            // Add animation
            setTimeout(() => {
                subwayMapOverlay.classList.add('active');
            }, 100);
        }
        
        function closeSubwayMap() {
            const overlay = document.getElementById('subway-map-overlay');
            if (overlay) {
                overlay.classList.remove('active');
                setTimeout(() => {
                    document.body.removeChild(overlay);
                }, 300);
            }
        }
        
        function checkSubwayStatus(type) {
            const statusMessages = {
                'real-time': 'Checking real-time subway status and arrival times...',
                'delays': 'Checking for any subway delays or service disruptions...',
                'routes': 'Opening route planner for optimal subway navigation...',
                'alerts': 'Checking for any service alerts or announcements...'
            };
            
            speak(statusMessages[type]);
            
            // Update the map display with relevant information
            const mapDisplay = document.querySelector('.subway-map-display');
            if (mapDisplay) {
                mapDisplay.innerHTML = `
                    <div class="map-update">
                        <div class="update-icon">${type === 'real-time' ? 'üöá' : type === 'delays' ? '‚ö†Ô∏è' : type === 'routes' ? 'üó∫Ô∏è' : 'üö®'}</div>
                        <h3>${type.charAt(0).toUpperCase() + type.slice(1)} Check</h3>
                        <p>${statusMessages[type]}</p>
                        <div class="status-update">
                            <p><strong>Status:</strong> Information updated successfully</p>
                            <p><strong>Time:</strong> ${new Date().toLocaleTimeString()}</p>
                        </div>
                    </div>
                `;
            }
        }
        
        // Celebration function
        function celebrate() {
            speak("Congratulations! You're all set for a wonderful evening!");
            
            // Create confetti effect
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    createConfetti();
                }, i * 100);
            }
        }
        
        function createConfetti() {
            const confetti = document.createElement('div');
            confetti.style.position = 'fixed';
            confetti.style.left = Math.random() * 100 + 'vw';
            confetti.style.top = '-10px';
            confetti.style.width = '10px';
            confetti.style.height = '10px';
            confetti.style.backgroundColor = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3'][Math.floor(Math.random() * 6)];
            confetti.style.borderRadius = '50%';
            confetti.style.pointerEvents = 'none';
            confetti.style.zIndex = '9999';
            confetti.style.animation = 'confettiFall 3s linear forwards';
            
            document.body.appendChild(confetti);
            
            setTimeout(() => {
                document.body.removeChild(confetti);
            }, 3000);
        }
        
        // Add confetti animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes confettiFall {
                to {
                    transform: translateY(100vh) rotate(73
                    20deg);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
        
        // Optional: Greet user on load
        window.onload = () => {
            loadTimeSettings();
            requestNotificationPermission();
            startReminderSystem();
            setTimeout(() => speak("Welcome, Hamed. Ready to thrive today?"), 1000);
        };

        // 1. Add a helper to pulse the emoji button
        function pulseEmojiForPortal(portal) {
            // Map portal to emoji button index
            const portalIndex = { 'daycare': 0, 'evening': 1, 'class': 2 };
            const idx = portalIndex[portal];
            const emojiBtns = document.querySelectorAll('.main-emoji-btn');
            if (emojiBtns[idx]) {
                emojiBtns[idx].classList.add('emoji-pulse');
                setTimeout(() => {
                    emojiBtns[idx].classList.remove('emoji-pulse');
                }, 3000);
            }
        }

        // Add CSS for .emoji-pulse
        const emojiPulseStyle = document.createElement('style');
        emojiPulseStyle.textContent = `
        .emoji-pulse {
            animation: emojiPulseAuto 1s cubic-bezier(0.4, 0, 0.6, 1) 0s 3 alternate;
            box-shadow: 0 0 0 8px #ffe06688, 0 0 0 16px #667eea44;
        }
        @keyframes emojiPulseAuto {
            0% { transform: scale(1); }
            50% { transform: scale(1.15) rotate(-2deg); }
            100% { transform: scale(1); }
        }
        `;
        document.head.appendChild(emojiPulseStyle);

        // 1. Make main daycare time editable
        const daycareTimeEl = document.getElementById('daycare-time');
        if (daycareTimeEl) {
            daycareTimeEl.style.cursor = 'pointer';
            daycareTimeEl.title = 'Click to edit time';
            daycareTimeEl.onclick = function() {
                const currentTime = daycareTimeEl.textContent;
                const newTime = prompt('Enter new time for Daycare Pickup (e.g., 5:00 PM):', currentTime);
                if (newTime && newTime.trim() !== '') {
                    daycareTimeEl.textContent = newTime.trim();
                    saveTimeSettings();
                    speak(`Time updated for Daycare Pickup to ${newTime}`);
                }
            };
        }

        // 2. Ensure Taxi sub-task time is editable (main list and detail)
        document.querySelectorAll('.task-time').forEach(function(el) {
            // Only add if it's for taxi and doesn't already have an onclick
            if ((el.parentElement && el.parentElement.textContent.includes('Taxi')) && !el.onclick) {
                el.style.cursor = 'pointer';
                el.title = 'Click to edit time';
                el.onclick = function() {
                    editTaskTime(el, 'daycare', 'taxi');
                };
            }
        });
    </script>
</body>
</html> 